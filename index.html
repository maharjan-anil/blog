<!DOCTYPE html>
<html lang="en" id="htmlRoot">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Blog</title>
<!-- Critical Theme FOUC Fix -->
<script>
(function() {
const theme = localStorage.getItem('theme') ||
(window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
document.documentElement.setAttribute('data-theme', theme);
if (theme === 'dark') {
document.documentElement.dataset.initialTheme = 'dark';
}
})();
</script>
<!-- Bootstrap 5 CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
<!-- Font Awesome Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<!-- Quill Rich Text Editor CSS -->
<link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
<!-- Google Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Open+Sans:wght@300;400;600&display=swap" rel="stylesheet">
<style>
:root {
--primary-color: #4a6fa5;
--secondary-color: #166088;
--accent-color: #4ECDC4;
--name-color: #ff6b35;
--light-color: #f8f9fa;
--dark-color: #343a40;
--text-color: #333;
--text-light: #777;
--card-bg: #ffffff;
--body-bg: #f9f9f9;
--transition: all 0.3s ease;
}
[data-theme="dark"] {
--primary-color: #5a8fd8;
--secondary-color: #2a7bc8;
--accent-color: #4ECDC4;
--name-color: #ff8c5a;
--light-color: #2d3748;
--dark-color: #1a202c;
--text-color: #e2e8f0;
--text-light: #a0aec0;
--card-bg: #2d3748;
--body-bg: #1a202c;
}
* {
margin: 0;
padding: 0;
box-sizing: border-box;
}
body {
font-family: 'Open Sans', sans-serif;
color: var(--text-color);
line-height: 1.6;
background-color: var(--body-bg);
overflow-x: hidden;
transition: var(--transition);
}
h1, h2, h3, h4, h5 {
font-family: 'Poppins', sans-serif;
font-weight: 600;
}
/* Navigation */
.navbar-custom {
background-color: var(--card-bg);
box-shadow: 0 2px 10px rgba(0,0,0,0.1);
padding: 15px 0;
position: sticky;
top: 0;
z-index: 1000;
transition: var(--transition);
}
.nav-brand {
font-family: 'Poppins', sans-serif;
font-weight: 700;
font-size: 1.5rem;
color: var(--primary-color) !important;
text-decoration: none;
cursor: pointer;
transition: var(--transition);
}
.nav-brand:hover {
color: var(--name-color) !important;
transform: scale(1.02);
}
.nav-brand span {
color: var(--name-color);
}
/* Admin Info in Navbar */
.admin-info {
display: flex;
align-items: center;
gap: 10px;
margin-left: 15px;
}
.admin-avatar {
width: 36px;
height: 36px;
border-radius: 50%;
background-color: var(--accent-color);
display: flex;
align-items: center;
justify-content: center;
color: white;
font-weight: 600;
font-size: 0.9rem;
}
.admin-name {
font-weight: 600;
color: var(--primary-color);
}
.admin-btn {
background-color: var(--primary-color);
color: white;
border: none;
padding: 8px 20px;
border-radius: 25px;
font-weight: 600;
transition: var(--transition);
cursor: pointer;
}
.admin-btn:hover {
background-color: var(--name-color);
transform: translateY(-2px);
}
.logout-btn {
background-color: #dc3545;
color: white;
border: none;
padding: 8px 20px;
border-radius: 25px;
font-weight: 600;
transition: var(--transition);
cursor: pointer;
}
.logout-btn:hover {
background-color: #c82333;
transform: translateY(-2px);
}
/* Theme Toggle Button */
.theme-toggle {
background: none;
border: 2px solid var(--primary-color);
color: var(--primary-color);
width: 45px;
height: 45px;
border-radius: 50%;
display: flex;
align-items: center;
justify-content: center;
transition: var(--transition);
margin-left: 10px;
cursor: pointer;
}
.theme-toggle:hover {
background-color: var(--primary-color);
color: white;
transform: rotate(30deg);
}
/* Search Input in Navbar */
.navbar-search-input {
background-color: var(--body-bg);
color: var(--text-color);
border: 1px solid var(--light-color);
border-radius: 20px;
padding: 6px 15px;
width: 200px;
transition: var(--transition);
font-size: 0.9rem;
}
.navbar-search-input:focus {
outline: none;
border-color: var(--primary-color);
box-shadow: 0 0 0 3px rgba(74, 111, 165, 0.1);
}
/* Hero Section */
.hero-section {
background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
color: white;
padding: 100px 0 60px;
position: relative;
overflow: hidden;
text-align: center;
}
.hero-section::before {
content: "";
position: absolute;
top: 0;
left: 0;
width: 100%;
height: 100%;
background-image: url("image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z' fill='%23000000' fill-opacity='0.05' fill-rule='evenodd'/%3E%3C/svg%3E");
opacity: 0.2;
}
.hero-content {
position: relative;
z-index: 2;
}
.page-title {
font-size: 3.5rem;
font-weight: 700;
margin-bottom: 20px;
text-shadow: 2px 2px 8px rgba(0,0,0,0.3);
color: white;
}
.page-subtitle {
font-size: 1.5rem;
font-weight: 300;
opacity: 0.9;
max-width: 700px;
margin: 0 auto;
}
/* Blog Section */
.blog-section {
padding: 80px 0;
}
.section-title {
text-align: center;
margin-bottom: 50px;
color: var(--primary-color);
font-size: 2.5rem;
position: relative;
padding-bottom: 15px;
}
.section-title::after {
content: "";
position: absolute;
bottom: 0;
left: 50%;
transform: translateX(-50%);
width: 100px;
height: 4px;
background-color: var(--name-color);
border-radius: 2px;
}
/* Blog Container with Sidebar */
.blog-container {
display: grid;
grid-template-columns: 1fr 320px;
gap: 40px;
}
/* Archive Sidebar */
.archive-sidebar {
background-color: var(--card-bg);
border-radius: 15px;
padding: 25px;
box-shadow: 0 10px 30px rgba(0,0,0,0.08);
height: fit-content;
position: sticky;
top: 100px;
}
.archive-title {
font-size: 1.3rem;
color: var(--primary-color);
margin-bottom: 20px;
padding-bottom: 10px;
border-bottom: 2px solid var(--light-color);
}
.archive-title i {
margin-right: 8px;
color: var(--accent-color);
}
.archive-list {
list-style: none;
padding: 0;
margin: 0;
}
.archive-item {
margin-bottom: 8px;
}
.archive-link {
display: flex;
justify-content: space-between;
align-items: center;
padding: 10px 15px;
background-color: var(--body-bg);
border-radius: 8px;
color: var(--text-color);
text-decoration: none;
transition: var(--transition);
cursor: pointer;
}
.archive-link:hover {
background-color: var(--primary-color);
color: white;
transform: translateX(5px);
}
.archive-link.active {
background-color: var(--name-color);
color: white;
}
.archive-count {
background-color: var(--accent-color);
color: white;
padding: 2px 10px;
border-radius: 12px;
font-size: 0.8rem;
font-weight: 600;
}
.archive-link:hover .archive-count {
background-color: white;
color: var(--accent-color);
}
.archive-link.active .archive-count {
background-color: white;
color: var(--name-color);
}
/* Blog Cards */
.blog-card {
background-color: var(--card-bg);
border-radius: 15px;
padding: 30px;
box-shadow: 0 10px 30px rgba(0,0,0,0.08);
transition: var(--transition);
margin-bottom: 30px;
border-left: 5px solid var(--accent-color);
position: relative;
}
.blog-card:hover {
transform: translateY(-5px);
box-shadow: 0 15px 40px rgba(0,0,0,0.12);
}
/* Post Title Clickable */
.blog-title {
font-size: 1.8rem;
color: var(--primary-color);
font-weight: 700;
margin-bottom: 15px;
line-height: 1.3;
cursor: pointer;
transition: var(--transition);
}
.blog-title:hover {
color: var(--name-color);
}
/* Post Actions */
.post-actions {
position: absolute;
top: 15px;
right: 15px;
display: flex;
gap: 8px;
opacity: 0;
transition: var(--transition);
}
.blog-card:hover .post-actions {
opacity: 1;
}
.action-btn {
width: 36px;
height: 36px;
border-radius: 50%;
display: flex;
align-items: center;
justify-content: center;
border: none;
cursor: pointer;
font-size: 0.9rem;
transition: var(--transition);
box-shadow: 0 2px 5px rgba(0,0,0,0.1);
}
.edit-btn {
background-color: var(--accent-color);
color: white;
}
.edit-btn:hover {
background-color: #3ab7af;
transform: scale(1.1);
}
.delete-btn {
background-color: #dc3545;
color: white;
}
.delete-btn:hover {
background-color: #c82333;
transform: scale(1.1);
}
.blog-header {
display: flex;
justify-content: space-between;
align-items: center;
margin-bottom: 20px;
padding-bottom: 15px;
border-bottom: 2px solid var(--light-color);
}
.blog-meta {
display: flex;
gap: 20px;
font-size: 0.9rem;
color: var(--text-light);
}
.blog-meta i {
margin-right: 5px;
}
.admin-badge {
display: inline-block;
background-color: var(--primary-color);
color: white;
padding: 3px 10px;
border-radius: 15px;
font-size: 0.85rem;
font-weight: 600;
}
/* Content Preview with More Lines */
.blog-content {
color: var(--text-color);
margin-bottom: 20px;
line-height: 1.8;
}
.blog-content-preview {
display: -webkit-box;
-webkit-line-clamp: 5;
-webkit-box-orient: vertical;
overflow: hidden;
text-overflow: ellipsis;
max-height: 150px;
}
/* Read More Button - Smaller Size */
.read-more-btn {
display: inline-flex;
align-items: center;
gap: 6px;
background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
color: white;
padding: 6px 18px;
border-radius: 20px;
text-decoration: none;
font-weight: 600;
transition: var(--transition);
cursor: pointer;
border: none;
font-size: 0.85rem;
margin-top: 12px;
}
.read-more-btn:hover {
background: linear-gradient(135deg, var(--name-color), var(--primary-color));
transform: translateX(5px);
color: white;
box-shadow: 0 5px 15px rgba(0,0,0,0.2);
}
.read-more-btn i {
transition: var(--transition);
font-size: 0.75rem;
}
.read-more-btn:hover i {
transform: translateX(3px);
}
/* Featured/Post Title Image */
.featured-image {
width: 100%;
height: 350px;
object-fit: cover;
border-radius: 15px;
margin-bottom: 25px;
box-shadow: 0 10px 30px rgba(0,0,0,0.15);
}
.blog-image {
width: 100%;
height: auto;
border-radius: 10px;
margin: 20px 0;
box-shadow: 0 5px 15px rgba(0,0,0,0.1);
max-height: 500px;
object-fit: cover;
}
.blog-video {
width: 100%;
height: 400px;
border-radius: 10px;
margin: 20px 0;
}
/* Single Post View */
.single-post-view {
display: none;
}
.single-post-view.active {
display: block;
}
.blog-list-view {
display: block;
}
.blog-list-view.hidden {
display: none;
}
.single-post-header {
margin-bottom: 30px;
}
.single-post-title {
font-size: 2.5rem;
color: var(--primary-color);
font-weight: 700;
margin-bottom: 20px;
line-height: 1.3;
}
.single-post-meta {
display: flex;
gap: 25px;
font-size: 1rem;
color: var(--text-light);
margin-bottom: 20px;
padding-bottom: 20px;
border-bottom: 2px solid var(--light-color);
}
.single-post-meta i {
margin-right: 8px;
color: var(--accent-color);
}
.single-post-content {
font-size: 1.1rem;
line-height: 1.9;
color: var(--text-color);
}
.single-post-content img {
max-width: 100%;
height: auto;
border-radius: 10px;
margin: 20px 0;
}
.single-post-content video {
max-width: 100%;
border-radius: 10px;
margin: 20px 0;
}
.single-post-content iframe {
width: 100%;
height: 500px;
border-radius: 10px;
margin: 20px 0;
border: none;
box-shadow: 0 5px 20px rgba(0,0,0,0.15);
}
/* Video in Quill Editor - Larger Size */
.ql-editor iframe {
width: 100% !important;
height: 450px !important;
max-width: 100%;
border-radius: 10px;
}
.ql-container .ql-video {
width: 100% !important;
height: 450px !important;
}
.back-to-posts-btn {
display: inline-flex;
align-items: center;
gap: 10px;
background-color: var(--primary-color);
color: white;
padding: 10px 25px;
border-radius: 25px;
text-decoration: none;
font-weight: 600;
transition: var(--transition);
cursor: pointer;
border: none;
margin-bottom: 30px;
}
.back-to-posts-btn:hover {
background-color: var(--name-color);
transform: translateX(-5px);
color: white;
}
/* Move to All Posts Button */
.move-to-all-posts-btn {
display: inline-flex;
align-items: center;
gap: 10px;
background: linear-gradient(135deg, var(--accent-color), var(--primary-color));
color: white;
padding: 12px 30px;
border-radius: 30px;
text-decoration: none;
font-weight: 600;
transition: var(--transition);
cursor: pointer;
border: none;
margin-top: 30px;
font-size: 1rem;
}
.move-to-all-posts-btn:hover {
background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
transform: translateY(-3px);
color: white;
box-shadow: 0 8px 20px rgba(0,0,0,0.3);
}
.move-to-all-posts-btn i {
transition: var(--transition);
}
.move-to-all-posts-btn:hover i {
transform: rotate(-45deg);
}
/* Create Post Button */
.create-post-btn {
position: fixed;
bottom: 30px;
right: 30px;
background-color: var(--name-color);
color: white;
width: 60px;
height: 60px;
border-radius: 50%;
display: flex;
align-items: center;
justify-content: center;
box-shadow: 0 5px 15px rgba(0,0,0,0.3);
transition: var(--transition);
z-index: 100;
border: none;
cursor: pointer;
}
.create-post-btn:hover {
transform: scale(1.1) rotate(90deg);
box-shadow: 0 8px 25px rgba(0,0,0,0.4);
}
.create-post-btn i {
font-size: 1.5rem;
}
/* Modal Form */
.form-control-custom {
background-color: var(--card-bg);
color: var(--text-color);
border: 2px solid var(--light-color);
border-radius: 8px;
padding: 12px 15px;
transition: var(--transition);
width: 100%;
}
.form-control-custom:focus {
border-color: var(--primary-color);
box-shadow: 0 0 0 3px rgba(74, 111, 165, 0.1);
outline: none;
}
.form-label {
font-weight: 600;
color: var(--primary-color);
margin-bottom: 8px;
display: block;
}
textarea.form-control-custom {
min-height: 150px;
resize: vertical;
}
.submit-btn {
background-color: var(--primary-color);
color: white;
border: none;
padding: 12px 30px;
border-radius: 50px;
font-weight: 600;
font-size: 1.1rem;
transition: var(--transition);
cursor: pointer;
width: 100%;
}
.submit-btn:hover {
background-color: var(--name-color);
transform: translateY(-2px);
box-shadow: 0 5px 15px rgba(0,0,0,0.2);
}
.submit-btn:disabled {
background-color: var(--text-light);
cursor: not-allowed;
transform: none;
}
/* Quill Editor */
.quill-editor {
background-color: var(--card-bg);
border: 2px solid var(--light-color);
border-radius: 8px;
transition: var(--transition);
}
.quill-editor:focus-within {
border-color: var(--primary-color);
box-shadow: 0 0 0 3px rgba(74, 111, 165, 0.1);
}
.ql-toolbar {
border-radius: 8px 8px 0 0 !important;
}
.ql-container {
border-radius: 0 0 8px 8px !important;
min-height: 300px;
}
.ql-editor {
font-family: 'Open Sans', sans-serif;
font-size: 1rem;
color: var(--text-color);
background-color: var(--card-bg);
min-height: 400px;
}
[data-theme="dark"] .ql-editor {
background-color: var(--card-bg);
color: var(--text-color);
}
/* Image & Video Upload Buttons in Editor */
.media-upload-btn {
background-color: var(--accent-color);
color: white;
border: none;
padding: 8px 15px;
border-radius: 5px;
cursor: pointer;
font-size: 0.9rem;
transition: var(--transition);
margin-top: 10px;
margin-right: 10px;
}
.media-upload-btn:hover {
background-color: var(--primary-color);
transform: translateY(-2px);
}
.media-upload-btn.video-btn {
background-color: var(--primary-color);
}
.media-upload-btn.video-btn:hover {
background-color: var(--name-color);
}
/* Loading Spinner */
.spinner {
width: 40px;
height: 40px;
border: 4px solid rgba(74, 111, 165, 0.3);
border-top: 4px solid var(--primary-color);
border-radius: 50%;
animation: spin 1s linear infinite;
margin: 20px auto;
}
@keyframes spin {
0% { transform: rotate(0deg); }
100% { transform: rotate(360deg); }
}
/* No Posts Message */
.no-posts {
text-align: center;
padding: 60px 20px;
color: var(--text-light);
}
.no-posts i {
font-size: 4rem;
color: var(--accent-color);
margin-bottom: 20px;
}
.no-posts p {
font-size: 1.2rem;
margin-top: 15px;
}
/* Alert Messages */
.alert-custom {
padding: 15px;
border-radius: 8px;
margin-bottom: 20px;
display: none;
}
.alert-success {
background-color: #d4edda;
color: #155724;
border: 1px solid #c3e6cb;
}
.alert-error {
background-color: #f8d7da;
color: #721c24;
border: 1px solid #f5c6cb;
}
/* Login Modal */
.login-modal {
max-width: 450px;
}
.login-header {
text-align: center;
padding: 20px 0;
border-bottom: 2px solid var(--light-color);
margin-bottom: 30px;
}
.login-header i {
font-size: 3rem;
color: var(--primary-color);
margin-bottom: 10px;
}
.login-header h3 {
color: var(--primary-color);
margin-bottom: 5px;
}
.login-header p {
color: var(--text-light);
font-size: 0.9rem;
}
/* Footer */
.footer-section {
background-color: var(--dark-color);
color: white;
padding: 40px 0;
text-align: center;
transition: background-color 0.3s ease;
}
.copyright {
font-size: 1rem;
color: rgba(255,255,255,0.8);
}
/* Current Filter Badge */
.current-filter {
display: inline-block;
background-color: var(--accent-color);
color: white;
padding: 8px 20px;
border-radius: 25px;
font-weight: 600;
margin-bottom: 20px;
}
.current-filter i {
margin-right: 8px;
}
.clear-filter {
margin-left: 10px;
cursor: pointer;
opacity: 0.8;
transition: var(--transition);
}
.clear-filter:hover {
opacity: 1;
}
/* Share Buttons */
.share-buttons {
display: flex;
gap: 10px;
margin-top: 30px;
padding-top: 20px;
border-top: 2px solid var(--light-color);
}
.share-btn {
width: 40px;
height: 40px;
border-radius: 50%;
display: flex;
align-items: center;
justify-content: center;
border: none;
cursor: pointer;
transition: var(--transition);
color: white;
}
.share-btn.facebook {
background-color: #3b5998;
}
.share-btn.twitter {
background-color: #1da1f2;
}
.share-btn.linkedin {
background-color: #0077b5;
}
.share-btn.whatsapp {
background-color: #25d366;
}
.share-btn:hover {
transform: scale(1.1);
}
/* Responsive */
@media (max-width: 992px) {
.blog-container {
grid-template-columns: 1fr;
}
.archive-sidebar {
position: static;
margin-bottom: 30px;
}
.page-title { font-size: 2.8rem; }
.section-title { font-size: 2rem; }
.blog-title { font-size: 1.6rem; }
.single-post-title { font-size: 2rem; }
.post-actions {
position: static;
margin-top: 15px;
opacity: 1;
}
.admin-info {
flex-direction: column;
align-items: flex-start;
gap: 5px;
}
.navbar-search-input {
width: 100%;
margin-bottom: 10px;
}
.ql-editor iframe {
height: 400px !important;
}
.single-post-content iframe {
height: 450px;
}
}
@media (max-width: 768px) {
.hero-section { padding: 80px 0 50px; }
.page-title { font-size: 2.2rem; }
.page-subtitle { font-size: 1.2rem; }
.blog-section { padding: 60px 0; }
.section-title { font-size: 1.8rem; margin-bottom: 40px; }
.blog-card { padding: 25px; }
.create-post-btn {
bottom: 20px;
right: 20px;
width: 50px;
height: 50px;
}
.blog-video {
height: 300px;
}
.ql-container {
min-height: 250px;
}
.single-post-title { font-size: 1.8rem; }
.single-post-meta {
flex-direction: column;
gap: 10px;
}
.blog-content-preview {
-webkit-line-clamp: 4;
max-height: 120px;
}
.read-more-btn {
padding: 5px 15px;
font-size: 0.8rem;
}
.move-to-all-posts-btn {
width: 100%;
justify-content: center;
}
.featured-image {
height: 250px;
}
.media-upload-btn {
display: block;
width: 100%;
margin-bottom: 10px;
}
.ql-editor iframe {
height: 350px !important;
}
.single-post-content iframe {
height: 350px;
}
}
@media (max-width: 576px) {
.page-title { font-size: 1.8rem; }
.nav-brand { font-size: 1.3rem; }
.blog-title { font-size: 1.4rem; }
.blog-meta {
flex-direction: column;
gap: 8px;
}
.blog-video {
height: 250px;
}
.action-btn {
width: 32px;
height: 32px;
font-size: 0.8rem;
}
.ql-toolbar.ql-snow .ql-formats {
margin-right: 8px;
}
.featured-image {
height: 200px;
}
.ql-editor iframe {
height: 300px !important;
}
.single-post-content iframe {
height: 300px;
}
}
</style>
</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-expand-lg navbar-custom">
<div class="container">
<a class="navbar-brand nav-brand" href="index.html" onclick="window.location.href='index.html'; return false;" aria-label="Home">Anil <span>Maharjan</span></a>
<button
class="navbar-toggler"
type="button"
data-bs-toggle="collapse"
data-bs-target="#navbarNav"
aria-controls="navbarNav"
aria-expanded="false"
aria-label="Toggle navigation"
>
<span class="navbar-toggler-icon"></span>
</button>
<div class="collapse navbar-collapse" id="navbarNav">
<ul class="navbar-nav ms-auto align-items-center">
<!-- Search Input -->
<li class="nav-item me-3">
<input type="text" id="searchInput" class="navbar-search-input" placeholder="Search posts or tags...">
</li>
<li class="nav-item" id="authNav">
<!-- Auth buttons will be inserted here dynamically -->
</li>
<li class="nav-item">
<button class="theme-toggle" id="themeToggle" aria-label="Toggle dark mode">
<i class="fas fa-moon"></i>
</button>
</li>
</ul>
</div>
</div>
</nav>

<!-- Hero Section -->
<section class="hero-section">
<div class="container">
<div class="row">
<div class="col-lg-10 mx-auto hero-content">
<h1 class="page-title">My Blog</h1>
<p class="page-subtitle">Thoughts, experiences, story and insights on productivity, and personal growth</p>
</div>
</div>
</div>
</section>

<!-- Blog Section -->
<section class="blog-section">
<div class="container">
<h2 class="section-title">Latest Posts</h2>
<div id="blogAlertContainer"></div>

<!-- Current Filter Badge -->
<div id="currentFilterBadge" style="display: none;"></div>

<div class="blog-container">
<!-- Blog Posts -->
<div id="blogPostsContainer">
<!-- Blog List View -->
<div id="blogListView" class="blog-list-view">
<div class="text-center">
<div class="spinner"></div>
<p>Loading posts...</p>
</div>
</div>

<!-- Single Post View -->
<div id="singlePostView" class="single-post-view">
<button class="back-to-posts-btn" id="backToPostsBtn">
<i class="fas fa-arrow-left"></i>Back to All Posts
</button>
<div id="singlePostContent"></div>
</div>
</div>

<!-- Archive Sidebar -->
<aside class="archive-sidebar">
<h3 class="archive-title"><i class="fas fa-archive"></i>Archives</h3>
<div id="archiveListContainer">
<div class="text-center">
<div class="spinner" style="width: 30px; height: 30px;"></div>
</div>
</div>
</aside>
</div>
</div>
</section>

<!-- Create Post Button -->
<button class="create-post-btn" id="createPostBtn" aria-label="Create new post" style="display: none;">
<i class="fas fa-plus"></i>
</button>

<!-- Admin Login Modal -->
<div class="modal fade" id="adminLoginModal" tabindex="-1" aria-hidden="true" aria-labelledby="adminLoginModalLabel">
<div class="modal-dialog modal-dialog-centered login-modal">
<div class="modal-content">
<div class="modal-header border-0 pb-0">
<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
</div>
<div class="modal-body">
<div class="login-header">
<i class="fas fa-user-shield"></i>
<h3>Admin Login</h3>
<p>Sign in to manage blog posts</p>
</div>
<div id="loginAlertContainer"></div>
<form id="adminLoginForm">
<div class="mb-3">
<label for="adminEmail" class="form-label">Email Address</label>
<input type="email" class="form-control-custom" id="adminEmail" required placeholder="admin@yourdomain.com">
</div>
<div class="mb-3">
<label for="adminPassword" class="form-label">Password</label>
<input type="password" class="form-control-custom" id="adminPassword" required placeholder="Enter your password">
</div>
<div class="mb-3 form-check">
<input type="checkbox" class="form-check-input" id="rememberAdmin">
<label class="form-check-label" for="rememberAdmin">Remember me</label>
</div>
<button type="submit" class="submit-btn" id="submitAdminLoginBtn">
<i class="fas fa-sign-in-alt me-2"></i>Sign In
</button>
</form>
</div>
</div>
</div>
</div>

<!-- Create/Edit Post Modal -->
<div class="modal fade" id="postModal" tabindex="-1" aria-hidden="true" aria-labelledby="postModalLabel">
<div class="modal-dialog modal-lg">
<div class="modal-content">
<div class="modal-header">
<h5 class="modal-title" id="postModalLabel">Create New Post</h5>
<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
</div>
<div class="modal-body">
<div id="formAlertContainer"></div>
<form id="postForm">
<input type="hidden" id="postId">
<div class="mb-3">
<label for="postTitle" class="form-label">Post Title *</label>
<input type="text" class="form-control-custom" id="postTitle" required placeholder="Enter post title">
</div>
<div class="mb-3">
<label for="featuredImage" class="form-label">
<i class="fas fa-image me-2"></i>Featured Image URL (optional)
</label>
<input type="url" class="form-control-custom" id="featuredImage" placeholder="https://example.com/featured-image.jpg">
<small class="text-muted"><i class="fas fa-info-circle me-1"></i>This image will be displayed at the top of your post</small>
</div>
<div class="mb-3">
<label for="postContent" class="form-label">Content *</label>
<div id="quillEditor">
<p><br></p>
</div>
<input type="hidden" id="postContent" name="postContent" required>
<!-- Image & Video Upload Options -->
<div class="mt-2">
<button type="button" class="media-upload-btn" id="insertImageUrlBtn">
<i class="fas fa-link me-2"></i>Insert Image from URL
</button>
<button type="button" class="media-upload-btn" id="uploadImageBtn" style="background-color: var(--primary-color);">
<i class="fas fa-upload me-2"></i>Upload Image from Computer
</button>
<button type="button" class="media-upload-btn video-btn" id="insertVideoUrlBtn">
<i class="fas fa-video me-2"></i>Insert Video from URL
</button>
</div>
<input type="file" id="imageFileInput" accept="image/*" style="display: none;">
</div>
<div class="mb-3">
<label for="postImage" class="form-label">
<i class="fas fa-images me-2"></i>Additional Image URL (optional)
</label>
<input type="url" class="form-control-custom" id="postImage" placeholder="https://example.com/image.jpg">
<small class="text-muted">Additional image to display within the post content</small>
</div>
<div class="mb-3">
<label for="postVideo" class="form-label">
<i class="fab fa-youtube me-2"></i>YouTube Video ID (optional)
</label>
<input type="text" class="form-control-custom" id="postVideo" placeholder="Enter YouTube video ID (e.g., dQw4w9WgXcQ)">
<small class="text-muted">Only YouTube videos supported</small>
</div>
<div class="mb-3">
<label for="postTags" class="form-label">
<i class="fas fa-tags me-2"></i>Tags (optional)
</label>
<input type="text" class="form-control-custom" id="postTags" placeholder="tag1, tag2, tag3">
<small class="text-muted">Separate tags with commas</small>
</div>
<button type="submit" class="submit-btn" id="submitPostBtn">
<i class="fas fa-paper-plane me-2"></i>Publish Post
</button>
</form>
</div>
</div>
</div>
</div>

<!-- Delete Confirmation Modal -->
<div class="modal fade" id="deleteConfirmModal" tabindex="-1" aria-hidden="true" aria-labelledby="deleteConfirmModalLabel">
<div class="modal-dialog modal-dialog-centered">
<div class="modal-content">
<div class="modal-header">
<h5 class="modal-title" id="deleteConfirmModalLabel">Confirm Deletion</h5>
<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
</div>
<div class="modal-body text-center">
<i class="fas fa-exclamation-triangle" style="font-size: 4rem; color: #dc3545; margin-bottom: 20px;"></i>
<p class="lead">Are you sure you want to delete this post?</p>
<p class="text-muted">This action cannot be undone.</p>
</div>
<div class="modal-footer justify-content-center">
<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
<button type="button" class="btn btn-danger" id="confirmDeleteBtn">Delete Post</button>
</div>
</div>
</div>
</div>

<!-- Footer -->
<footer class="footer-section">
<div class="container">
<div class="row">
<div class="col-12">
<div class="copyright">
<p>&copy; <span id="currentYear"></span> Anil Maharjan</p>
</div>
</div>
</div>
</div>
</footer>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>
<!-- Quill Rich Text Editor -->
<script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
<script>
// === FIREBASE CONFIGURATION ===
const firebaseConfig = {
apiKey: "AIzaSyATt6Bc5-Jes8zXz6aLp9b9wi9OPFhVE0s",
authDomain: "anil-blog-af680.firebaseapp.com",
projectId: "anil-blog-af680",
storageBucket: "anil-blog-af680.firebasestorage.app",
messagingSenderId: "702295756466",
appId: "1:702295756466:web:df537c87f0ef46d0d943ab"
};

// DOM Elements
const html = document.getElementById('htmlRoot');
const toggleBtn = document.getElementById('themeToggle');
const icon = toggleBtn.querySelector('i');
const createPostBtn = document.getElementById('createPostBtn');
const postForm = document.getElementById('postForm');
const postModalLabel = document.getElementById('postModalLabel');
const submitPostBtn = document.getElementById('submitPostBtn');
const postIdInput = document.getElementById('postId');
const blogPostsContainer = document.getElementById('blogPostsContainer');
const blogListView = document.getElementById('blogListView');
const singlePostView = document.getElementById('singlePostView');
const singlePostContent = document.getElementById('singlePostContent');
const backToPostsBtn = document.getElementById('backToPostsBtn');
const blogAlertContainer = document.getElementById('blogAlertContainer');
const formAlertContainer = document.getElementById('formAlertContainer');
const loginAlertContainer = document.getElementById('loginAlertContainer');
const deleteConfirmModal = document.getElementById('deleteConfirmModal');
const confirmDeleteBtn = document.getElementById('confirmDeleteBtn');
const authNav = document.getElementById('authNav');
const adminLoginForm = document.getElementById('adminLoginForm');
const submitAdminLoginBtn = document.getElementById('submitAdminLoginBtn');
const searchInput = document.getElementById('searchInput');
const archiveListContainer = document.getElementById('archiveListContainer');
const currentFilterBadge = document.getElementById('currentFilterBadge');
const insertImageUrlBtn = document.getElementById('insertImageUrlBtn');
const uploadImageBtn = document.getElementById('uploadImageBtn');
const insertVideoUrlBtn = document.getElementById('insertVideoUrlBtn');
const imageFileInput = document.getElementById('imageFileInput');

let currentPostId = null;
let currentUser = null;
let quill = null;
let allPosts = [];
let currentArchiveFilter = null;
let currentPostData = null;
let storage = null;

// Set current year
document.getElementById('currentYear').textContent = new Date().getFullYear();

// === THEME SYSTEM ===
if (html.dataset.initialTheme === 'dark') {
icon.className = 'fas fa-sun';
}

function applyTheme(theme) {
html.setAttribute('data-theme', theme);
icon.className = theme === 'dark' ? 'fas fa-sun' : 'fas fa-moon';
localStorage.setItem('theme', theme);
if (quill) {
const editor = document.querySelector('.ql-editor');
if (editor) {
editor.style.backgroundColor = theme === 'dark' ? '#2d3748' : '#ffffff';
editor.style.color = theme === 'dark' ? '#e2e8f0' : '#333333';
}
}
window.dispatchEvent(new CustomEvent('themeChanged', { detail: theme }));
}

toggleBtn.addEventListener('click', () => {
const current = html.getAttribute('data-theme');
const newTheme = current === 'dark' ? 'light' : 'dark';
applyTheme(newTheme);
});

window.addEventListener('storage', function(e) {
if (e.key === 'theme') {
applyTheme(e.newValue);
}
});

// === FIREBASE INITIALIZATION ===
let db = null;
let auth = null;
let firebaseInitialized = false;

function showBlogAlert(message, type = 'error') {
const alertDiv = document.createElement('div');
alertDiv.className = `alert-custom alert-${type === 'error' ? 'error' : 'success'}`;
alertDiv.innerHTML = `<i class="fas fa-${type === 'error' ? 'exclamation-triangle' : 'check-circle'} me-2"></i>${message}`;
blogAlertContainer.innerHTML = '';
blogAlertContainer.appendChild(alertDiv);
alertDiv.style.display = 'block';
setTimeout(() => {
alertDiv.style.display = 'none';
}, 5000);
}

function showFormAlert(message, type = 'error', container = formAlertContainer) {
const alertDiv = document.createElement('div');
alertDiv.className = `alert-custom alert-${type === 'error' ? 'error' : 'success'}`;
alertDiv.innerHTML = `<i class="fas fa-${type === 'error' ? 'exclamation-triangle' : 'check-circle'} me-2"></i>${message}`;
container.innerHTML = '';
container.appendChild(alertDiv);
alertDiv.style.display = 'block';
setTimeout(() => {
alertDiv.style.display = 'none';
}, 5000);
}

// Initialize Firebase
function initializeFirebase() {
try {
if (firebaseConfig.apiKey === "AIzaSyC..." ||
firebaseConfig.projectId === "your-project-id") {
throw new Error("Firebase config not updated! Please replace with your actual Firebase config values.");
}
if (!firebase.apps.length) {
firebase.initializeApp(firebaseConfig);
}
db = firebase.firestore();
auth = firebase.auth();
storage = firebase.storage();
auth.onAuthStateChanged(user => {
currentUser = user;
updateAuthUI();
if (user) {
console.log('✅ Admin signed in:', user.email);
loadBlogPosts();
} else {
console.log('❌ Admin not signed in');
loadBlogPosts();
}
});
firebaseInitialized = true;
console.log('✅ Firebase initialized successfully');
} catch (error) {
console.error('❌ Firebase setup error:', error);
showBlogAlert(`Configuration error: ${error.message}`, 'error');
firebaseInitialized = false;
}
}

// Update auth UI based on user state
function updateAuthUI() {
if (currentUser) {
const displayName = currentUser.displayName || currentUser.email.split('@')[0];
const initials = displayName.charAt(0).toUpperCase();
authNav.innerHTML = `
<div class="admin-info">
<div class="admin-avatar">${initials}</div>
<span class="admin-name">${displayName}</span>
<button class="logout-btn" id="logoutBtn">Logout</button>
</div>
`;
createPostBtn.style.display = 'flex';
document.getElementById('logoutBtn').addEventListener('click', signOutAdmin);
} else {
authNav.innerHTML = `
<button class="admin-btn" id="adminLoginBtn">Admin Login</button>
`;
createPostBtn.style.display = 'none';
document.getElementById('adminLoginBtn').addEventListener('click', () => {
new bootstrap.Modal(document.getElementById('adminLoginModal')).show();
});
}
}

// Sign in admin
async function signInAdmin(email, password) {
try {
const userCredential = await auth.signInWithEmailAndPassword(email, password);
const user = userCredential.user;
console.log('✅ Admin authenticated:', user.email);
bootstrap.Modal.getInstance(document.getElementById('adminLoginModal')).hide();
return true;
} catch (error) {
console.error('Admin sign-in error:', error);
throw error;
}
}

// Sign out
async function signOutAdmin() {
try {
await auth.signOut();
showBlogAlert('Signed out successfully!', 'success');
} catch (error) {
console.error('Sign out error:', error);
showBlogAlert('Sign out failed: ' + error.message, 'error');
}
}

// === RICH TEXT EDITOR ===
function initializeQuillEditor() {
quill = new Quill('#quillEditor', {
modules: {
toolbar: [
[{ 'header': [1, 2, 3, 4, 5, 6, false] }],
['bold', 'italic', 'underline', 'strike'],
[{ 'color': [] }, { 'background': [] }],
[{ 'font': [] }],
[{ 'size': ['small', false, 'large', 'huge'] }],
[{ 'list': 'ordered'}, { 'list': 'bullet' }],
[{ 'align': [] }],
[{ 'indent': '-1'}, { 'indent': '+1' }],
['blockquote', 'code-block'],
['link', 'image', 'video'],
['clean'],
['formula']
]
},
theme: 'snow',
placeholder: 'Write your post content here...'
});
const savedContent = localStorage.getItem('quillContent');
if (savedContent) {
quill.root.innerHTML = savedContent;
}
quill.on('text-change', function() {
document.getElementById('postContent').value = quill.root.innerHTML;
localStorage.setItem('quillContent', quill.root.innerHTML);
});
applyTheme(html.getAttribute('data-theme'));
}

function clearQuillEditor() {
if (quill) {
quill.root.innerHTML = '<p><br></p>';
localStorage.removeItem('quillContent');
document.getElementById('postContent').value = '';
}
}

// === IMAGE & VIDEO UPLOAD FUNCTIONALITY ===
// Insert image from URL
insertImageUrlBtn.addEventListener('click', () => {
const imageUrl = prompt('Enter image URL:');
if (imageUrl) {
const range = quill.getSelection(true);
quill.insertEmbed(range.index, 'image', imageUrl);
quill.setSelection(range.index + 1);
}
});

// Upload image from computer
uploadImageBtn.addEventListener('click', () => {
imageFileInput.click();
});

imageFileInput.addEventListener('change', async (e) => {
const file = e.target.files[0];
if (!file) return;

// Validate file type
if (!file.type.startsWith('image/')) {
showFormAlert('Please select a valid image file!', 'error');
return;
}

// Validate file size (max 5MB)
if (file.size > 5 * 1024 * 1024) {
showFormAlert('Image size must be less than 5MB!', 'error');
return;
}

// Show loading state
const originalBtnText = uploadImageBtn.innerHTML;
uploadImageBtn.disabled = true;
uploadImageBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Uploading...';

try {
// Upload to Firebase Storage
const storageRef = storage.ref();
const imageRef = storageRef.child(`blog-images/${Date.now()}_${file.name}`);
const uploadTask = await imageRef.put(file);
const downloadURL = await uploadTask.ref.getDownloadURL();

// Insert image into editor
const range = quill.getSelection(true);
quill.insertEmbed(range.index, 'image', downloadURL);
quill.setSelection(range.index + 1);

showFormAlert('Image uploaded successfully!', 'success');
} catch (error) {
console.error('Image upload error:', error);
showFormAlert('Failed to upload image: ' + error.message, 'error');
} finally {
uploadImageBtn.disabled = false;
uploadImageBtn.innerHTML = originalBtnText;
imageFileInput.value = '';
}
});

// Insert video from URL
insertVideoUrlBtn.addEventListener('click', () => {
const videoUrl = prompt('Enter video URL (YouTube, Vimeo, or direct video link):');
if (videoUrl) {
const range = quill.getSelection(true);

// Extract video ID for YouTube/Vimeo or use direct URL
let embedUrl = videoUrl;

// YouTube URL handling
const youtubeMatch = videoUrl.match(/(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/\s]{11})/);
if (youtubeMatch) {
embedUrl = `https://www.youtube.com/embed/${youtubeMatch[1]}`;
}

// Vimeo URL handling
const vimeoMatch = videoUrl.match(/vimeo\.com\/(?:channels\/(?:\w+\/)?|groups\/(?:\w+\/)?|album\/(?:\d+\/)?video\/|)(\d+)(?:$|\/|\?)/);
if (vimeoMatch) {
embedUrl = `https://player.vimeo.com/video/${vimeoMatch[1]}`;
}

// Insert video into editor
quill.insertEmbed(range.index, 'video', embedUrl);
quill.setSelection(range.index + 1);

showFormAlert('Video inserted successfully!', 'success');
}
});

// === ARCHIVE FUNCTIONALITY ===
function getMonthYearKey(date) {
const months = ['January', 'February', 'March', 'April', 'May', 'June',
'July', 'August', 'September', 'October', 'November', 'December'];
return {
key: `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}`,
display: `${months[date.getMonth()]} ${date.getFullYear()}`,
year: date.getFullYear(),
month: date.getMonth()
};
}

function groupPostsByArchive(posts) {
const archiveMap = {};
posts.forEach(post => {
const date = post.createdAt ? post.createdAt.toDate() : new Date();
const { key, display } = getMonthYearKey(date);
if (!archiveMap[key]) {
archiveMap[key] = { display, count: 0, posts: [] };
}
archiveMap[key].count++;
archiveMap[key].posts.push(post);
});
return Object.entries(archiveMap)
.sort((a, b) => b[0].localeCompare(a[0]))
.map(([key, data]) => ({ key, ...data }));
}

function renderArchiveList(archiveData) {
if (archiveData.length === 0) {
archiveListContainer.innerHTML = `
<div class="text-center text-muted">
<i class="fas fa-archive" style="font-size: 2rem; margin-bottom: 10px;"></i>
<p>No archives yet</p>
</div>
`;
return;
}
let html = '<ul class="archive-list">';
archiveData.forEach(archive => {
const isActive = currentArchiveFilter === archive.key;
html += `
<li class="archive-item">
<div class="archive-link ${isActive ? 'active' : ''}" data-archive-key="${archive.key}">
<span><i class="far fa-calendar-alt me-2"></i>${archive.display}</span>
<span class="archive-count">${archive.count}</span>
</div>
</li>
`;
});
html += '</ul>';
archiveListContainer.innerHTML = html;

document.querySelectorAll('.archive-link').forEach(link => {
link.addEventListener('click', () => {
const archiveKey = link.getAttribute('data-archive-key');
filterByArchive(archiveKey);
});
});
}

function filterByArchive(archiveKey) {
if (currentArchiveFilter === archiveKey) {
currentArchiveFilter = null;
currentFilterBadge.style.display = 'none';
} else {
currentArchiveFilter = archiveKey;
const archive = allPosts.find(p => {
const date = p.createdAt ? p.createdAt.toDate() : new Date();
const { key } = getMonthYearKey(date);
return key === archiveKey;
});
if (archive) {
const { display } = getMonthYearKey(archive.createdAt ? archive.createdAt.toDate() : new Date());
currentFilterBadge.innerHTML = `
<span class="current-filter">
<i class="fas fa-filter"></i>Showing: ${display}
<span class="clear-filter" id="clearArchiveFilter"><i class="fas fa-times"></i></span>
</span>
`;
currentFilterBadge.style.display = 'block';
document.getElementById('clearArchiveFilter').addEventListener('click', () => {
currentArchiveFilter = null;
currentFilterBadge.style.display = 'none';
renderBlogPosts(allPosts);
updateArchiveUI();
});
}
}
const filteredPosts = currentArchiveFilter
? allPosts.filter(p => {
const date = p.createdAt ? p.createdAt.toDate() : new Date();
const { key } = getMonthYearKey(date);
return key === currentArchiveFilter;
})
: allPosts;
renderBlogPosts(filteredPosts);
updateArchiveUI();
}

function updateArchiveUI() {
document.querySelectorAll('.archive-link').forEach(link => {
const key = link.getAttribute('data-archive-key');
if (key === currentArchiveFilter) {
link.classList.add('active');
} else {
link.classList.remove('active');
}
});
}

// === BLOG FUNCTIONALITY ===
async function loadBlogPosts() {
if (!firebaseInitialized || !db) {
blogListView.innerHTML = `
<div class="alert alert-warning">
<i class="fas fa-exclamation-triangle me-2"></i>
Firebase not initialized. Please check console for errors.
</div>
`;
return;
}
try {
blogListView.innerHTML = `
<div class="text-center">
<div class="spinner"></div>
<p>Loading posts...</p>
</div>
`;
const postsRef = db.collection('blogPosts').orderBy('createdAt', 'desc');
const snapshot = await postsRef.get();
if (snapshot.empty) {
blogListView.innerHTML = `
<div class="no-posts">
<i class="fas fa-inbox"></i>
<h3>No posts yet</h3>
<p>Be the first to share your thoughts!</p>
</div>
`;
archiveListContainer.innerHTML = `
<div class="text-center text-muted">
<p>No archives yet</p>
</div>
`;
return;
}
allPosts = [];
snapshot.forEach(doc => {
allPosts.push({ id: doc.id, ...doc.data() });
});
const archiveData = groupPostsByArchive(allPosts);
renderArchiveList(archiveData);
renderBlogPosts(allPosts);
} catch (error) {
console.error('Error loading posts:', error);
blogListView.innerHTML = `
<div class="alert alert-danger">
<i class="fas fa-exclamation-triangle me-2"></i>
<strong>Error:</strong> ${error.message}<br>
<small>Check Firestore Rules and Firebase config</small>
</div>
`;
}
}

// Strip HTML tags and get plain text
function stripHtmlTags(html) {
const tempDiv = document.createElement('div');
tempDiv.innerHTML = html;
return tempDiv.textContent || tempDiv.innerText || '';
}

// Get content preview with more text
function getContentPreview(content, charLimit = 400) {
const plainText = stripHtmlTags(content);
if (plainText.length <= charLimit) {
return plainText;
}
let preview = plainText.substring(0, charLimit);
const lastPeriod = preview.lastIndexOf('.');
if (lastPeriod > charLimit * 0.7) {
preview = preview.substring(0, lastPeriod + 1);
}
return preview.trim() + '...';
}

function renderBlogPosts(posts) {
if (posts.length === 0) {
blogListView.innerHTML = `
<div class="no-posts">
<i class="fas fa-search"></i>
<h3>No posts found</h3>
<p>Try a different filter or search term</p>
</div>
`;
return;
}
let postsHTML = '';
posts.forEach(post => {
const postId = post.id;
const date = post.createdAt ? post.createdAt.toDate() : new Date();
const formattedDate = date.toLocaleDateString('en-US', {
year: 'numeric',
month: 'long',
day: 'numeric'
});
// Featured image for blog list
let featuredImageHTML = '';
if (post.featuredImage) {
featuredImageHTML = `<img src="${post.featuredImage}" alt="${post.title}" class="featured-image">`;
}
let mediaHTML = '';
if (post.imageUrl) {
mediaHTML = `<img src="${post.imageUrl}" alt="Post image" class="blog-image">`;
}
if (post.videoId) {
mediaHTML = `
<div class="ratio ratio-16x9 blog-video">
<iframe src="https://www.youtube.com/embed/${post.videoId}"
frameborder="0"
allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
allowfullscreen>
</iframe>
</div>
`;
}
const tagsHTML = post.tags && post.tags.length > 0
? `<div class="blog-tags mt-3">
${post.tags.map(tag => `<span class="badge bg-secondary me-2">#${tag}</span>`).join('')}
</div>`
: '';
const actionsHTML = currentUser ? `
<div class="post-actions">
<button class="action-btn edit-btn" data-post-id="${postId}" title="Edit post">
<i class="fas fa-edit"></i>
</button>
<button class="action-btn delete-btn" data-post-id="${postId}" title="Delete post">
<i class="fas fa-trash"></i>
</button>
</div>
` : '';
const contentPreview = getContentPreview(post.content, 400);
postsHTML += `
<div class="blog-card" data-post-id="${postId}">
${actionsHTML}
<div class="blog-header">
<div class="blog-meta">
<span><i class="fas fa-calendar"></i> ${formattedDate}</span>
<span><i class="fas fa-user"></i> ${post.authorName || 'Admin'}</span>
${currentUser ? '<span class="admin-badge"><i class="fas fa-user-shield"></i> Admin</span>' : ''}
</div>
</div>
${featuredImageHTML}
<h3 class="blog-title" data-post-id="${postId}" title="Click to read full post">
${post.title}
</h3>
<div class="blog-content blog-content-preview">
${contentPreview}
</div>
${mediaHTML ? `<div style="margin-top: 15px;"><span class="badge bg-primary"><i class="fas fa-image me-1"></i>Has Media</span></div>` : ''}
${tagsHTML}
<button class="read-more-btn" data-post-id="${postId}" title="Read full post">
Read More <i class="fas fa-arrow-right"></i>
</button>
</div>
`;
});
blogListView.innerHTML = postsHTML;

document.querySelectorAll('.blog-title').forEach(title => {
title.addEventListener('click', (e) => {
e.stopPropagation();
const postId = title.getAttribute('data-post-id');
openSinglePost(postId);
});
});

document.querySelectorAll('.read-more-btn').forEach(btn => {
btn.addEventListener('click', (e) => {
e.stopPropagation();
const postId = btn.getAttribute('data-post-id');
openSinglePost(postId);
});
});

document.querySelectorAll('.edit-btn').forEach(btn => {
btn.addEventListener('click', (e) => {
e.stopPropagation();
const postId = btn.getAttribute('data-post-id');
openEditModal(postId);
});
});
document.querySelectorAll('.delete-btn').forEach(btn => {
btn.addEventListener('click', (e) => {
e.stopPropagation();
const postId = btn.getAttribute('data-post-id');
openDeleteConfirm(postId);
});
});
}

// === SINGLE POST VIEW ===
function openSinglePost(postId) {
const post = allPosts.find(p => p.id === postId);
if (!post) {
showBlogAlert('Post not found!', 'error');
return;
}
currentPostData = post;
const date = post.createdAt ? post.createdAt.toDate() : new Date();
const formattedDate = date.toLocaleDateString('en-US', {
year: 'numeric',
month: 'long',
day: 'numeric'
});
// Featured image at the top of single post
let featuredImageHTML = '';
if (post.featuredImage) {
featuredImageHTML = `<img src="${post.featuredImage}" alt="${post.title}" class="featured-image">`;
}
let mediaHTML = '';
if (post.imageUrl) {
mediaHTML = `<img src="${post.imageUrl}" alt="Post image" class="blog-image">`;
}
if (post.videoId) {
mediaHTML = `
<div class="ratio ratio-16x9 blog-video">
<iframe src="https://www.youtube.com/embed/${post.videoId}"
frameborder="0"
allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
allowfullscreen>
</iframe>
</div>
`;
}
const tagsHTML = post.tags && post.tags.length > 0
? `<div class="blog-tags mt-4">
<h5><i class="fas fa-tags me-2"></i>Tags:</h5>
${post.tags.map(tag => `<span class="badge bg-secondary me-2">#${tag}</span>`).join('')}
</div>`
: '';
const adminActionsHTML = currentUser ? `
<div class="admin-actions mt-4" style="display: flex; gap: 10px;">
<button class="btn btn-primary" onclick="openEditModal('${postId}')">
<i class="fas fa-edit me-2"></i>Edit Post
</button>
<button class="btn btn-danger" onclick="openDeleteConfirm('${postId}')">
<i class="fas fa-trash me-2"></i>Delete Post
</button>
</div>
` : '';
const shareButtonsHTML = `
<div class="share-buttons">
<h5 style="margin-right: 15px;"><i class="fas fa-share-alt me-2"></i>Share:</h5>
<button class="share-btn facebook" onclick="sharePost('facebook')" title="Share on Facebook">
<i class="fab fa-facebook-f"></i>
</button>
<button class="share-btn twitter" onclick="sharePost('twitter')" title="Share on Twitter">
<i class="fab fa-twitter"></i>
</button>
<button class="share-btn linkedin" onclick="sharePost('linkedin')" title="Share on LinkedIn">
<i class="fab fa-linkedin-in"></i>
</button>
<button class="share-btn whatsapp" onclick="sharePost('whatsapp')" title="Share on WhatsApp">
<i class="fab fa-whatsapp"></i>
</button>
</div>
`;
const moveToAllPostsHTML = `
<div style="text-align: center; margin-top: 40px;">
<button class="move-to-all-posts-btn" id="moveToAllPostsBtn">
<i class="fas fa-list-ul"></i>Move to All Posts
</button>
</div>
`;
singlePostContent.innerHTML = `
<div class="single-post-header">
<h1 class="single-post-title">${post.title}</h1>
<div class="single-post-meta">
<span><i class="fas fa-calendar"></i> ${formattedDate}</span>
<span><i class="fas fa-user"></i> ${post.authorName || 'Admin'}</span>
<span><i class="fas fa-clock"></i> ${getReadTime(post.content)} min read</span>
</div>
</div>
${featuredImageHTML}
<div class="single-post-content">
${post.content}
</div>
${mediaHTML}
${tagsHTML}
${adminActionsHTML}
${shareButtonsHTML}
${moveToAllPostsHTML}
`;
blogListView.classList.add('hidden');
singlePostView.classList.add('active');
window.scrollTo({ top: 0, behavior: 'smooth' });
window.location.hash = `post-${postId}`;

document.getElementById('moveToAllPostsBtn').addEventListener('click', closeSinglePost);
}

function closeSinglePost() {
blogListView.classList.remove('hidden');
singlePostView.classList.remove('active');
currentPostData = null;
window.location.hash = '';
}

function getReadTime(content) {
const text = content.replace(/<[^>]*>/g, '');
const words = text.split(/\s+/).length;
return Math.ceil(words / 200);
}

function sharePost(platform) {
if (!currentPostData) return;
const url = encodeURIComponent(window.location.href);
const title = encodeURIComponent(currentPostData.title);
let shareUrl = '';
switch(platform) {
case 'facebook':
shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${url}`;
break;
case 'twitter':
shareUrl = `https://twitter.com/intent/tweet?url=${url}&text=${title}`;
break;
case 'linkedin':
shareUrl = `https://www.linkedin.com/shareArticle?mini=true&url=${url}&title=${title}`;
break;
case 'whatsapp':
shareUrl = `https://wa.me/?text=${title}%20${url}`;
break;
}
if (shareUrl) {
window.open(shareUrl, '_blank', 'width=600,height=400');
}
}

backToPostsBtn.addEventListener('click', closeSinglePost);

window.addEventListener('load', () => {
const hash = window.location.hash;
if (hash && hash.startsWith('#post-')) {
const postId = hash.replace('#post-', '');
setTimeout(() => {
openSinglePost(postId);
}, 1000);
}
});

async function openEditModal(postId) {
if (!currentUser) {
showAdminLoginModal();
return;
}
try {
const postDoc = await db.collection('blogPosts').doc(postId).get();
if (!postDoc.exists) {
showFormAlert('Post not found!', 'error');
return;
}
const post = postDoc.data();
postIdInput.value = postId;
document.getElementById('postTitle').value = post.title || '';
document.getElementById('featuredImage').value = post.featuredImage || '';
document.getElementById('postImage').value = post.imageUrl || '';
document.getElementById('postVideo').value = post.videoId || '';
document.getElementById('postTags').value = post.tags ? post.tags.join(', ') : '';
if (quill) {
quill.root.innerHTML = post.content || '<p><br></p>';
localStorage.setItem('quillContent', post.content || '<p><br></p>');
document.getElementById('postContent').value = post.content || '';
}
postModalLabel.textContent = 'Edit Post';
submitPostBtn.innerHTML = '<i class="fas fa-save me-2"></i>Update Post';
new bootstrap.Modal(document.getElementById('postModal')).show();
} catch (error) {
console.error('Error loading post for edit:', error);
showFormAlert('Failed to load post: ' + error.message, 'error');
}
}

async function savePost(postData, postId = null) {
try {
if (!firebaseInitialized || !db || !currentUser) {
throw new Error('You must be signed in as admin to create/edit posts');
}
const postToSave = {
...postData,
authorId: currentUser.uid,
authorName: currentUser.displayName || currentUser.email.split('@')[0],
authorEmail: currentUser.email
};
if (postId) {
await db.collection('blogPosts').doc(postId).update({
...postToSave,
updatedAt: firebase.firestore.FieldValue.serverTimestamp()
});
console.log('✅ Post updated with ID:', postId);
} else {
const docRef = await db.collection('blogPosts').add({
...postToSave,
createdAt: firebase.firestore.FieldValue.serverTimestamp()
});
console.log('✅ Post created with ID:', docRef.id);
}
return true;
} catch (error) {
console.error('❌ Error saving post:', error);
throw error;
}
}

async function deletePost(postId) {
try {
if (!firebaseInitialized || !db || !currentUser) {
throw new Error('You must be signed in as admin to delete posts');
}
await db.collection('blogPosts').doc(postId).delete();
console.log('✅ Post deleted with ID:', postId);
return true;
} catch (error) {
console.error('❌ Error deleting post:', error);
throw error;
}
}

postForm.addEventListener('submit', async (e) => {
e.preventDefault();
if (!currentUser) {
showAdminLoginModal();
return;
}
const postId = postIdInput.value.trim();
const title = document.getElementById('postTitle').value.trim();
const content = document.getElementById('postContent').value.trim();
const featuredImage = document.getElementById('featuredImage').value.trim();
const imageUrl = document.getElementById('postImage').value.trim();
const videoId = document.getElementById('postVideo').value.trim();
const tagsInput = document.getElementById('postTags').value.trim();
const tags = tagsInput ? tagsInput.split(',').map(tag => tag.trim()).filter(tag => tag) : [];
if (!title || !content) {
showFormAlert('Title and content are required!', 'error');
return;
}
const originalBtnText = submitPostBtn.innerHTML;
submitPostBtn.disabled = true;
submitPostBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i> Saving...';
const postData = {
title,
content,
featuredImage: featuredImage || null,
imageUrl: imageUrl || null,
videoId: videoId || null,
tags
};
try {
const success = await savePost(postData, postId ? postId : null);
if (success) {
postForm.reset();
postIdInput.value = '';
clearQuillEditor();
const modal = bootstrap.Modal.getInstance(document.getElementById('postModal'));
if (modal) modal.hide();
postModalLabel.textContent = 'Create New Post';
submitPostBtn.innerHTML = '<i class="fas fa-paper-plane me-2"></i>Publish Post';
showFormAlert(postId ? 'Post updated successfully!' : 'Post published successfully!', 'success');
setTimeout(() => {
currentArchiveFilter = null;
currentFilterBadge.style.display = 'none';
closeSinglePost();
loadBlogPosts();
}, 500);
}
} catch (error) {
showFormAlert(`Failed to save: ${error.message}`, 'error');
} finally {
submitPostBtn.disabled = false;
submitPostBtn.innerHTML = originalBtnText;
}
});

function openDeleteConfirm(postId) {
if (!currentUser) {
showAdminLoginModal();
return;
}
currentPostId = postId;
new bootstrap.Modal(deleteConfirmModal).show();
}

confirmDeleteBtn.addEventListener('click', async () => {
if (!currentPostId || !currentUser) return;
const originalBtnText = confirmDeleteBtn.innerHTML;
confirmDeleteBtn.disabled = true;
confirmDeleteBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i> Deleting...';
try {
const success = await deletePost(currentPostId);
if (success) {
bootstrap.Modal.getInstance(deleteConfirmModal).hide();
showBlogAlert('Post deleted successfully!', 'success');
currentArchiveFilter = null;
currentFilterBadge.style.display = 'none';
closeSinglePost();
loadBlogPosts();
}
} catch (error) {
showBlogAlert('Failed to delete post: ' + error.message, 'error');
} finally {
confirmDeleteBtn.disabled = false;
confirmDeleteBtn.innerHTML = originalBtnText;
currentPostId = null;
}
});

function showAdminLoginModal() {
new bootstrap.Modal(document.getElementById('adminLoginModal')).show();
}

createPostBtn.addEventListener('click', () => {
if (!currentUser) {
showAdminLoginModal();
return;
}
if (!firebaseInitialized) {
alert('Firebase is not initialized. Please check the console for errors.');
return;
}
postForm.reset();
postIdInput.value = '';
clearQuillEditor();
postModalLabel.textContent = 'Create New Post';
submitPostBtn.innerHTML = '<i class="fas fa-paper-plane me-2"></i>Publish Post';
new bootstrap.Modal(document.getElementById('postModal')).show();
});

adminLoginForm.addEventListener('submit', async (e) => {
e.preventDefault();
const email = document.getElementById('adminEmail').value.trim();
const password = document.getElementById('adminPassword').value.trim();
if (!email || !password) {
showFormAlert('Please enter both email and password', 'error', loginAlertContainer);
return;
}
const originalBtnText = submitAdminLoginBtn.innerHTML;
submitAdminLoginBtn.disabled = true;
submitAdminLoginBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i> Signing in...';
try {
await signInAdmin(email, password);
showFormAlert('Signed in successfully!', 'success', loginAlertContainer);
adminLoginForm.reset();
} catch (error) {
showFormAlert('Sign in failed: ' + error.message, 'error', loginAlertContainer);
} finally {
submitAdminLoginBtn.disabled = false;
submitAdminLoginBtn.innerHTML = originalBtnText;
}
});

// === SEARCH FUNCTIONALITY (WITH TAGS) ===
if (searchInput) {
searchInput.addEventListener('input', (e) => {
const term = e.target.value.toLowerCase();
const cards = document.querySelectorAll('.blog-card');
let hasResults = false;
const existingMsg = document.getElementById('searchNoResults');
if (existingMsg) existingMsg.remove();
cards.forEach(card => {
const title = card.querySelector('.blog-title') ? card.querySelector('.blog-title').textContent.toLowerCase() : '';
const content = card.querySelector('.blog-content') ? card.querySelector('.blog-content').textContent.toLowerCase() : '';
const tagBadges = card.querySelectorAll('.blog-tags .badge');
let tagsText = '';
tagBadges.forEach(badge => {
tagsText += badge.textContent.toLowerCase() + ' ';
});
if (title.includes(term) || content.includes(term) || tagsText.includes(term)) {
card.style.display = 'block';
hasResults = true;
} else {
card.style.display = 'none';
}
});
if (!hasResults && cards.length > 0) {
const noResultsMsg = document.createElement('div');
noResultsMsg.id = 'searchNoResults';
noResultsMsg.className = 'no-posts';
noResultsMsg.innerHTML = '<i class="fas fa-search"></i><h3>No posts found</h3><p>Try a different search term or tag</p>';
blogListView.appendChild(noResultsMsg);
}
});
}

document.addEventListener('DOMContentLoaded', () => {
initializeFirebase();
initializeQuillEditor();
});

document.querySelectorAll('a[href^="#"]').forEach(anchor => {
anchor.addEventListener('click', function(e) {
if (this.getAttribute('href') === '#') {
e.preventDefault();
window.scrollTo({ top: 0, behavior: 'smooth' });
}
});
});
</script>
</body>
</html>
